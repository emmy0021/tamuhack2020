<!DOCTYPE html>
<html land="en-us">

<head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <meta charset="UTF-8">
    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
        #map {
            height: 100%;
            width: 100%;
        }

        /* Optional: Makes the sample page fill the window. */
        html,
        body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }
    </style>

    

    
</head>

<body>



    <div id="floating-panel">
        <input type="text" id="inputtext" placeholder="City" value="">
        <button id="submit">submit</button>
        <button onclick="toggleHeatmap()">Toggle Heatmap</button>
        <button onclick="changeGradient()">Change gradient</button>
        <p id="lon"></p>
        <p id="lat"></p>
    </div>

    <marquee behavior="scroll" direction="left" scrollamount="1">Very slow...</marquee>
    <div id="map"></div>

    <script src="map.js"></script>
    <!-- Replace the value of the key parameter with your own API key. AIzaSyDutuTXuuUC-5ywb9P6j4OOs7u_sliwfwM -->
    <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDutuTXuuUC-5ywb9P6j4OOs7u_sliwfwM&libraries=visualization&callback=myMap">
    </script>

    <p>working</p>


    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/p5@0.10.2/lib/p5.min.js"></script>


    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/p5@0.10.2/lib/addons/p5.sound.min.js"></script>
    <script src="location.js" type="text/javascript"></script>
    


    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-firestore.js"></script>
    <script>
        var access_key = '145a6e1f8118cacc7daf96e2b3f5ab42';
        var ip = 'check';
        var city = '';
        var lon = '';
        var lat = '';

        var weather;
        var api = 'https://api.openweathermap.org/data/2.5/weather?';
        var apiKey = '&APPID=8697cfa385dec17d993f302610135c81';


        document.addEventListener("DOMContentLoaded", function () {

            getLocation();
        });

        function getLocation() {
            $.ajax({
                url: 'http://api.ipstack.com/' + ip + '?access_key=' + access_key,
                dataType: 'jsonp',
                success: function (json) {

                    // output the "capital" object inside "location"
                    console.log(json);

                    city = json.city;
                    lat = json.latitude;
                    lon = json.longitude;


                    outputCity();
                }
            });
        }

        function outputCity() {
            document.getElementById("inputtext").value = city;
            document.getElementById("lon").innerText = lon;
            document.getElementById("lat").innerText = lat;

        }

        ///weather
        function setup() {
            createCanvas(400, 200);
            var button = select('#submit');
            button.mousePressed(weatherAsk);
            button.mousePressed(writeData);
        }

        function weatherAsk() {
            var latitude = 'lat=' + lat;

            var longitude = '&lon=' + lon;
            var url = api + latitude + longitude + apiKey;
            
            loadJSON(url, gotData);
        }
        function gotData(data) {
            weather = data;
            console.log(weather.main.temp);
        }

        // Your web app's Firebase configuration

        var firebaseConfig = {
            apiKey: "AIzaSyCp__3sbc1Bj2B0h7Owyn_6KYH79XqkzC0",
            authDomain: "tamuhack2020-69538.firebaseapp.com",
            databaseURL: "https://tamuhack2020-69538.firebaseio.com",
            projectId: "tamuhack2020-69538",
            storageBucket: "tamuhack2020-69538.appspot.com",
            messagingSenderId: "489082793913",
            appId: "1:489082793913:web:918e698329f4482a1f1068",
            measurementId: "G-SBWE9WF6DT"
        };
        // Initialize Firebase
        
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
        var database = firebase.database();
        
        function writeData(){
            firebase.database().ref("coord").set({
                Latitude: 4,
                Longitude: 4,
                Temperature: 4
            })
        }
    </script>
</body>

</html>